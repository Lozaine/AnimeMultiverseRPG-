// Cross Realm Chronicles Wiki System
// Comprehensive documentation and help system for the Discord RPG Bot

const { EmbedBuilder, ActionRowBuilder, StringSelectMenuBuilder, ButtonBuilder, ButtonStyle } = require('discord.js');

const WIKI_CATEGORIES = {
    getting_started: {
        title: 'üöÄ Getting Started',
        description: 'New to Cross Realm Chronicles? Start here!',
        sections: [
            {
                name: 'Creating Your Character',
                content: `**Character Creation Guide**

Use \`/create <faction> [character_name]\` to begin your journey in Cross Realm Chronicles!

**üìã Faction Selection Process:**
When creating your character, you'll choose from four distinct anime universes, each offering unique gameplay experiences:

üè¥‚Äç‚ò†Ô∏è **One Piece Pirates** 
- **Philosophy:** Freedom, adventure, and the pursuit of dreams
- **Playstyle:** Exploration-focused with treasure hunting mechanics
- **Special Features:** Devil Fruit powers, crew dynamics, and naval adventures
- **Starting Benefits:** +5 HP, +3 ATK, +2 DEF, +5 SPD
- **Unique Mechanics:** Pirate's Intuition (+15% item find, +10% crit chance)

ü•∑ **Naruto Shinobi**
- **Philosophy:** Protecting your village and mastering ninja arts
- **Playstyle:** Balanced approach with stealth and tactical advantages
- **Special Features:** Chakra manipulation, elemental jutsu, and clan abilities
- **Starting Benefits:** +4 HP, +4 ATK, +3 DEF, +8 SPD
- **Unique Mechanics:** Basic Chakra Control (+3 all stats, +20% stealth)

üëÅÔ∏è **Jujutsu Sorcerers**
- **Philosophy:** Exorcising curses and protecting humanity from supernatural threats
- **Playstyle:** High-risk, high-reward combat with powerful techniques
- **Special Features:** Cursed energy manipulation, domain expansion, reverse techniques
- **Starting Benefits:** +3 HP, +6 ATK, +4 DEF, +6 SPD
- **Unique Mechanics:** Cursed Energy Manipulation (+25% vs cursed enemies)

‚öîÔ∏è **Demon Slayers**
- **Philosophy:** Dedication to protecting humanity through swordsmanship mastery
- **Playstyle:** Combat-focused with disciplined training progression
- **Special Features:** Breathing techniques, enhanced blade techniques, demon detection
- **Starting Benefits:** +6 HP, +7 ATK, +5 DEF, +4 SPD
- **Unique Mechanics:** Basic Breathing Technique (+4 ATK, +3 DEF, +15% stamina)

**üé≠ Character Naming System:**
- **Custom Names:** Create unique character identities separate from Discord usernames
- **Examples:** \`/create one_piece "Monkey D. Adventure"\`, \`/create naruto "Shadow Clone Master"\`
- **Default Option:** Omit character name to use your Discord username
- **Name Rules:** Can include spaces, special characters, and up to 32 characters
- **Immersion Factor:** Your character name appears in all game interactions and profiles

**‚ö° Post-Creation Tips:**
- Your faction choice is permanent - choose wisely based on your preferred playstyle
- Starting equipment and abilities are immediately available after creation
- Each faction has different XP and reward multipliers for various quest types
- You can view detailed faction information anytime with \`/wiki category:factions\`
- Your character begins at Level 1 with 100 XP needed to reach Level 2`
            },
            {
                name: 'Your First Quest Adventure',
                content: `**The Quest System - Your Path to Power**

After character creation, the quest system becomes your primary avenue for growth, rewards, and adventure. Understanding how quests work is crucial for optimal progression.

**üéØ Quest Mechanics Deep Dive:**

**Quest Generation System:**
- Quests are dynamically generated based on your character level, faction, and game progression
- Each quest attempt costs no resources but has a time commitment representing the adventure
- Success rates vary based on your stats, faction bonuses, and quest difficulty
- Higher-level characters unlock more challenging and rewarding quest types

**üìä Quest Categories Explained:**

üåø **Gathering Quests** - Resource Collection Adventures
- **Objective:** Collect herbs, minerals, magical components, and rare materials
- **Difficulty:** Low to Medium risk, consistent rewards
- **Best For:** One Piece Pirates (treasure hunting instincts), steady income generation
- **Rewards:** Crafting materials, moderate XP (50-150), reliable gold (20-60)
- **Special Features:** Chance for rare material discoveries, environmental interaction

‚öîÔ∏è **Hunting Quests** - Combat-Focused Missions
- **Objective:** Track and eliminate dangerous creatures, monsters, or threats
- **Difficulty:** Medium to High risk, high XP potential
- **Best For:** Demon Slayers and Jujutsu Sorcerers (combat specialists)
- **Rewards:** High XP (100-300), combat experience, rare equipment drops
- **Special Features:** Guaranteed enemy encounters, skill development opportunities

üì¶ **Delivery Quests** - Transportation Missions
- **Objective:** Transport items, messages, or people across distances safely
- **Difficulty:** Low to Medium risk, time-sensitive completion
- **Best For:** Naruto Shinobi (speed and stealth) and One Piece Pirates (navigation)
- **Rewards:** Consistent XP (75-200), relationship building, travel experience
- **Special Features:** Potential ambush encounters, reputation system integration

üõ°Ô∏è **Protection Quests** - Guardian Missions
- **Objective:** Defend locations, escort travelers, or guard important events
- **Difficulty:** Medium risk, strategic thinking required
- **Best For:** All factions (especially Naruto Shinobi and Demon Slayers)
- **Rewards:** High XP (120-250), community standing, defensive skill development
- **Special Features:** Wave-based challenges, tactical decision points

üèãÔ∏è **Training Quests** - Skill Development Missions
- **Objective:** Practice techniques, spar with masters, or undergo trials
- **Difficulty:** Controlled risk, personal growth focused
- **Best For:** All factions (especially beneficial for ability unlocking)
- **Rewards:** Massive XP bonuses (150-400), stat improvements, ability prerequisites
- **Special Features:** Faction-specific training, mastery progression tracking

üèòÔ∏è **Community Quests** - Social Service Missions
- **Objective:** Help local communities with various needs and problems
- **Difficulty:** Low risk, relationship and reputation focused
- **Best For:** Demon Slayers (community protection ethos)
- **Rewards:** Community reputation, steady income, social connections
- **Special Features:** Unlocks special community-based rewards and recognition

üìã **Errand Quests** - Simple Task Missions
- **Objective:** Complete straightforward tasks and odd jobs
- **Difficulty:** Very low risk, quick completion
- **Best For:** All factions (reliable income source)
- **Rewards:** Quick XP (25-100), immediate gold, task completion satisfaction
- **Special Features:** Fast turnaround, no combat risk, beginner-friendly

**üéÆ Your First Quest Strategy:**
1. **Start Simple:** Begin with Errand or Gathering quests to understand mechanics
2. **Faction Focus:** Choose quest types that align with your faction's bonuses
3. **Risk Management:** Balance safe quests with challenging ones for optimal growth
4. **Equipment Check:** Use items from your starting equipment to enhance success rates
5. **Experience Tracking:** Monitor XP gains to plan your leveling progression efficiently`
            },
            {
                name: 'Essential Commands Mastery',
                content: `**Complete Command Reference for New Players**

Understanding and mastering the command system is essential for effective gameplay in Cross Realm Chronicles. Each command serves specific purposes and has advanced features worth exploring.

**üîß Core Gameplay Commands:**

**\`/profile\` - Character Information Hub**
- **Primary Function:** Displays comprehensive character statistics and progression
- **Information Shown:** Level, XP progress, HP/ATK/DEF/SPD stats, faction details
- **Advanced Features:** Shows completed quest count, faction-specific attributes, level-up progress
- **Pro Tips:** Use regularly to track stat growth and plan progression strategies
- **Hidden Details:** Reveals faction ability unlock requirements and progression milestones

**\`/inventory\` - Item Management Center**
- **Primary Function:** Complete overview of all owned items and equipment
- **Organization:** Items grouped by type (consumables, equipment, quest items, rare materials)
- **Advanced Features:** Quantity tracking, item descriptions, usage suggestions
- **Pro Tips:** Regular inventory management prevents item overflow and optimizes storage
- **Strategic Use:** Plan item usage based on upcoming quests and current needs

**\`/use <item> [quantity]\` - Item Consumption System**
- **Primary Function:** Activate consumable items for immediate effects
- **Advanced Usage:** Specify quantities for bulk consumption (\`/use Health Potion 3\`)
- **Auto-Complete:** Start typing item names for intelligent suggestions from your inventory
- **Effect Stacking:** Multiple items can be used in succession for cumulative benefits
- **Pro Tips:** Save powerful items for challenging quests, use basic items for regular maintenance
- **Emergency Usage:** Keep healing items ready for post-combat recovery

**\`/quest\` - Adventure Initiation System**
- **Primary Function:** Start new quest adventures for XP, gold, and item rewards
- **Quest Selection:** System automatically selects appropriate quests based on your level and faction
- **Faction Bonuses:** Receive enhanced rewards for quest types aligned with your faction
- **Risk Assessment:** Each quest displays difficulty and potential rewards before acceptance
- **Pro Tips:** Vary quest types to maximize different faction bonuses and experience variety
- **Advanced Strategy:** Plan quest sequences to optimize XP gain and resource accumulation

**\`/reset\` - Character Reset Function**
- **Primary Function:** Completely restart your character progression (PERMANENT ACTION)
- **Warning System:** Requires explicit confirmation to prevent accidental resets
- **Complete Deletion:** Removes all progress, items, stats, and faction abilities
- **Use Cases:** Starting over with different faction, correcting early game mistakes
- **Important Note:** This action cannot be undone - consider carefully before using
- **Alternative:** Contact support for specific issues before resorting to full reset

**üéØ Command Usage Strategy:**
1. **Daily Routine:** Check \`/profile\` ‚Üí \`/inventory\` ‚Üí \`/quest\` for optimal progression flow
2. **Item Management:** Use \`/inventory\` before and after quests to track gains and plan usage
3. **Resource Optimization:** Use \`/use\` strategically before difficult quests for stat boosts
4. **Progress Tracking:** Regular \`/profile\` checks help identify when to focus on specific quest types
5. **Safety First:** Never use \`/reset\` without careful consideration and understanding of consequences

**üí° Advanced Command Tips:**
- Commands work in any channel where the bot has permissions
- Most commands provide helpful error messages if used incorrectly
- Tab completion works for command parameters in most Discord clients
- Commands process immediately but quest results may involve combat encounters
- All commands are logged for progress tracking and support purposes`
            }
        ]
    },
    factions: {
        title: '‚ö° Faction Guide',
        description: 'Master your chosen faction\'s unique abilities and playstyle',
        sections: [
            {
                name: 'üè¥‚Äç‚ò†Ô∏è One Piece Pirates',
                content: `**Theme:** Adventure, Freedom, Treasure Hunting
**Starting Ability:** Pirate's Intuition (+15% item find rate, +10% crit chance)

**Stat Bonuses:** +5 HP, +3 ATK, +2 DEF, +5 SPD
**Best Quest Types:** Gathering, Delivery, Hunting

**Progressive Abilities:**
‚Ä¢ **Lv 3:** Sea Legs - Immunity to water debuffs
‚Ä¢ **Lv 7:** Treasure Sense - Enhanced item discovery
‚Ä¢ **Lv 12:** Haki Awakening - Observation and Armament Haki
‚Ä¢ **Lv 18:** Devil Fruit Resonance - Enhanced Devil Fruit powers
‚Ä¢ **Lv 25:** Conqueror's Will - Intimidate weaker enemies

**Starting Equipment:**
üó°Ô∏è Cutlass, üß• Pirate Coat, üß≠ Navigator's Compass
üçñ Sea King Meat (2x), üó∫Ô∏è Treasure Map Fragment (1x)`
            },
            {
                name: 'ü•∑ Naruto Shinobi',
                content: `**Theme:** Stealth, Ninjutsu, Village Protection
**Starting Ability:** Basic Chakra Control (+3 all stats, +20% stealth success)

**Stat Bonuses:** +4 HP, +4 ATK, +3 DEF, +8 SPD
**Best Quest Types:** Protection, Training, Delivery

**Progressive Abilities:**
‚Ä¢ **Lv 4:** Shadow Clone Technique - Double training XP
‚Ä¢ **Lv 8:** Elemental Affinity - Master Fire/Water/Earth/Wind/Lightning
‚Ä¢ **Lv 13:** Advanced Ninjutsu - Enhanced stealth and jutsu combinations
‚Ä¢ **Lv 19:** Sage Mode Training - +35% all combat stats
‚Ä¢ **Lv 28:** Tailed Beast Partnership - Massive power boost

**Starting Equipment:**
üó°Ô∏è Kunai Set, ü•ã Ninja Gear, üìú Chakra Paper
üíä Soldier Pill (3x), üí® Smoke Bomb (2x)`
            },
            {
                name: 'üëÅÔ∏è Jujutsu Sorcerers',
                content: `**Theme:** Supernatural Combat, Cursed Energy, Exorcism  
**Starting Ability:** Cursed Energy Manipulation (+25% vs cursed enemies)

**Stat Bonuses:** +3 HP, +6 ATK, +4 DEF, +6 SPD
**Best Quest Types:** Hunting, Protection, Training

**Progressive Abilities:**
‚Ä¢ **Lv 5:** Cursed Technique Development - Unique personal ability
‚Ä¢ **Lv 9:** Reverse Cursed Technique - Healing and curse removal
‚Ä¢ **Lv 15:** Simple Domain - Defensive barrier technique
‚Ä¢ **Lv 22:** Domain Expansion - Personal domain space
‚Ä¢ **Lv 30:** Maximum Technique - Ultimate technique mastery

**Starting Equipment:**
‚öîÔ∏è Cursed Tool (Basic), üëî Sorcerer Uniform, üëÅÔ∏è Cursed Energy Detector
üíâ Cursed Energy Serum (2x), üõ°Ô∏è Protective Charm (1x)`
            },
            {
                name: '‚öîÔ∏è Demon Slayers',
                content: `**Theme:** Swordsmanship, Breathing Techniques, Demon Hunting
**Starting Ability:** Basic Breathing Technique (+4 ATK, +3 DEF, +15% stamina)

**Stat Bonuses:** +6 HP, +7 ATK, +5 DEF, +4 SPD  
**Best Quest Types:** Hunting, Training, Protection

**Progressive Abilities:**
‚Ä¢ **Lv 4:** Breathing Style Mastery - Choose Water/Thunder/Flame/Stone/Wind
‚Ä¢ **Lv 8:** Enhanced Blade Techniques - Advanced swordsmanship
‚Ä¢ **Lv 14:** Demon Slayer Mark - +50% all physical stats
‚Ä¢ **Lv 20:** See-Through World - Enemy weakness detection
‚Ä¢ **Lv 26:** Breathing Style Evolution - Create unique techniques

**Starting Equipment:**
‚öîÔ∏è Nichirin Blade, ü•ã Demon Slayer Corps Uniform, üìø Warding Charm
üíä Recovery Pill (2x), üåÖ Sunlight Essence (1x)`
            }
        ]
    },
    combat: {
        title: '‚öîÔ∏è Combat Guide',
        description: 'Master the art of battle and enemy encounters',
        sections: [
            {
                name: 'Combat Basics',
                content: `**Combat Stats:**
‚Ä¢ **HP** - Your health points, lose all and you're defeated
‚Ä¢ **ATK** - Attack power, determines damage dealt  
‚Ä¢ **DEF** - Defense, reduces incoming damage
‚Ä¢ **SPD** - Speed, affects dodge chance and turn order

**Critical Hits:**
Base 5% chance, increased by speed difference and combat style
Critical hits deal 150% damage`
            },
            {
                name: 'Enemy Types & Combat Styles',
                content: `**Enemy Combat Styles:**
üõ°Ô∏è **Tank** - High HP/DEF, low SPD, powerful attacks
üèÉ **Agile** - High SPD, low DEF, dodge-focused
‚öîÔ∏è **Aggressive** - High ATK, rushdown tactics
üõ°Ô∏è **Defensive** - High DEF, turtle-style combat
üí® **Evasive** - Extreme SPD, very low DEF
üêù **Swarm** - Multiple weak attacks, numbers advantage
üé≤ **Erratic** - Unpredictable, random variations
üèπ **Hit-and-Run** - Quick strikes then retreat

**Special Abilities:**
Many enemies have unique abilities with chance-based activation:
‚Ä¢ Pack Howl, Web Shot, Tusked Charge, Phase, Confuse, and more!`
            },
            {
                name: 'Weaknesses & Resistances',
                content: `**Weakness System:**
Enemies have specific vulnerabilities that deal +30% damage
Examples: Fire vs Forest Goblin, Light vs Will-o'-Wisp

**Resistance System:**  
Some enemies resist certain damage types for -30% damage
Examples: Cave Spider resists poison, Training Dummy resists physical

**Enemy Categories:**
üå≤ **Forest/Nature:** Goblins, Wolves, Spiders, Boars, Slimes
üë• **Humanoid:** Bandits, Merchants, Guards
‚ú® **Magical:** Will-o'-Wisps, Animated Scarecrows
üîß **Constructed:** Golems, Automatons  
ü¶Ö **Flying:** Bat Swarms, Carrion Crows`
            },
            {
                name: 'Enemy Encounter Rates',
                content: `**Base Rate:** 30% chance per quest
**Category Modifiers:**
‚Ä¢ Hunting quests: +15% encounter rate
‚Ä¢ Protection quests: +12% encounter rate  
‚Ä¢ Training quests: +20% encounter rate
‚Ä¢ Gathering quests: +5% encounter rate
‚Ä¢ Community work: -8% encounter rate
‚Ä¢ Simple errands: -5% encounter rate

**Level Scaling:** +2% encounter rate per level above 1
**Final Range:** 10% minimum, 55% maximum encounter rate`
            }
        ]
    },
    progression: {
        title: 'üìà Character Progression',
        description: 'Level up, unlock abilities, and grow stronger',
        sections: [
            {
                name: 'Experience & Leveling',
                content: `**XP Requirements:**
‚Ä¢ Level 1 ‚Üí 2: 100 XP
‚Ä¢ Level 2 ‚Üí 3: 200 XP  
‚Ä¢ Level 3 ‚Üí 4: 300 XP
‚Ä¢ Pattern: Each level requires (Level √ó 100) XP

**Level Up Bonuses:**
Every level up grants:
‚Ä¢ +10 HP (and max HP)
‚Ä¢ +2 ATK
‚Ä¢ +1 DEF  
‚Ä¢ +1 SPD

**XP Sources:**
‚Ä¢ Quest completion (varies by faction affinity)
‚Ä¢ Combat victories  
‚Ä¢ Special achievements
‚Ä¢ Using certain items (XP Potions, etc.)`
            },
            {
                name: 'Faction Abilities',
                content: `**Unlocking Abilities:**
Faction abilities require both level AND specific unlock conditions:

**Unlock Conditions Examples:**
‚Ä¢ Complete specific numbers of quest types
‚Ä¢ Win certain numbers of combat encounters
‚Ä¢ Reach relationship milestones
‚Ä¢ Discover rare items or locations
‚Ä¢ Demonstrate mastery of previous abilities

**Ability Effects:**
‚Ä¢ Stat bonuses and multipliers
‚Ä¢ New combat options and techniques  
‚Ä¢ Enhanced success rates for activities
‚Ä¢ Unique mechanics like healing, intimidation
‚Ä¢ Access to advanced equipment and items`
            },
            {
                name: 'Item Usage & Effects',
                content: `**Item Types:**
üçñ **HP Recovery** - Restore health points
üíô **MP Recovery** - Restore magic/chakra/cursed energy  
‚≠ê **XP Boost** - Gain experience points
üí∞ **Gold** - Increase your wealth
üõ°Ô∏è **Buffs** - Temporary stat increases
üí® **Utility** - Escape combat, stealth bonuses

**Using Items:**
\`/use <item_name> [quantity]\`
Items with multiple effects apply all benefits simultaneously
Some items trigger level ups if you gain enough XP!`
            },
            {
                name: 'Gold & Economy',
                content: `**Earning Gold:**
‚Ä¢ Quest completion rewards
‚Ä¢ Combat victory bonuses  
‚Ä¢ Faction-specific multipliers
‚Ä¢ Special treasure discoveries
‚Ä¢ Item usage effects

**Future Gold Uses:**
‚Ä¢ Equipment upgrades and purchases
‚Ä¢ Faction-specific items and tools
‚Ä¢ Training accelerators
‚Ä¢ Special quest unlocks
‚Ä¢ Marketplace trading (planned)`
            }
        ]
    },
    quests: {
        title: 'üéØ Quest System',
        description: 'Embark on adventures and complete missions',
        sections: [
            {
                name: 'Quest Categories',
                content: `**üåø Gathering Quests**
Collect herbs, minerals, and resources
‚Ä¢ Good for: One Piece Pirates (treasure hunting)
‚Ä¢ Rewards: Materials, moderate XP, good gold

**‚öîÔ∏è Hunting Quests**  
Battle monsters and dangerous creatures
‚Ä¢ Good for: Demon Slayers, Jujutsu Sorcerers
‚Ä¢ Rewards: High XP, combat experience, rare materials

**üì¶ Delivery Quests**
Transport items and messages across distances  
‚Ä¢ Good for: Naruto Shinobi, One Piece Pirates
‚Ä¢ Rewards: Good XP, reliable gold, reputation

**üõ°Ô∏è Protection Quests**
Guard locations, escort travelers, defend settlements
‚Ä¢ Good for: Naruto Shinobi, Demon Slayers
‚Ä¢ Rewards: High XP, community standing, equipment

**üèãÔ∏è Training Quests**
Practice techniques and improve abilities
‚Ä¢ Good for: All factions (especially Naruto)
‚Ä¢ Rewards: Massive XP bonuses, ability progress

**üèòÔ∏è Community Quests**
Help local communities with various needs
‚Ä¢ Good for: Demon Slayers, some factions
‚Ä¢ Rewards: Community reputation, steady rewards

**üìã Errand Quests**
Simple tasks and odd jobs
‚Ä¢ Good for: All factions (reliable income)
‚Ä¢ Rewards: Quick completion, steady gold`
            },
            {
                name: 'Faction Quest Bonuses',
                content: `**One Piece Pirates:**
‚Ä¢ Gathering: +20% XP, +40% coins, +25% items
‚Ä¢ Delivery: +30% XP, +20% coins, +10% items
‚Ä¢ Community: -20% XP, -10% coins (outsiders)

**Naruto Shinobi:**
‚Ä¢ Protection: +40% XP, +30% coins, +20% items  
‚Ä¢ Training: +50% XP, +30% items (mission specialists)
‚Ä¢ Delivery: +30% XP, +10% coins (excellent messengers)

**Jujutsu Sorcerers:**
‚Ä¢ Hunting: +40% XP, +20% coins, +30% items
‚Ä¢ Training: +30% XP, +40% items (technique development)
‚Ä¢ Community: -10% XP, -20% coins (secretive)

**Demon Slayers:**
‚Ä¢ Hunting: +50% XP, +30% coins, +40% items
‚Ä¢ Training: +40% XP, +30% items (intensive culture)  
‚Ä¢ Protection: +20% XP, +10% coins, +20% items`
            },
            {
                name: 'Enemy Encounters in Quests',
                content: `**When Enemies Appear:**
Encounters can happen during any quest based on:
‚Ä¢ Quest category (hunting = more fights)
‚Ä¢ Your character level (higher = more encounters)
‚Ä¢ Random chance with category modifiers

**Enemy Scaling:**
Enemies scale to your level with combat style bonuses:
‚Ä¢ Tank enemies get more HP and DEF
‚Ä¢ Agile enemies get more SPD  
‚Ä¢ Aggressive enemies get more ATK
‚Ä¢ Defensive enemies get more DEF

**Combat Rewards:**
‚Ä¢ Bonus XP for victory
‚Ä¢ Additional gold from defeated enemies
‚Ä¢ Possible rare item drops
‚Ä¢ Progress toward faction ability unlocks`
            }
        ]
    },
    items: {
        title: 'üéí Items & Inventory',
        description: 'Manage your equipment and consumables',
        sections: [
            {
                name: 'Using Items',
                content: `**Item Usage Command:**
\`/use <item_name> [quantity]\`

**Auto-Complete:**
The bot will suggest items from your inventory as you type
Works with partial names and fuzzy matching

**Multiple Effects:**
Many items provide multiple benefits:
‚Ä¢ **Health Potions:** Restore HP + MP
‚Ä¢ **XP Items:** Grant experience + stat boosts  
‚Ä¢ **Combat Items:** Attack bonus + critical chance
‚Ä¢ **Utility Items:** Multiple situational effects

**Quantity Usage:**
Specify how many to use: \`/use Health Potion 3\`
Default is 1 if no quantity specified`
            },
            {
                name: 'Item Categories',
                content: `**üíä Consumables**
Single-use items that provide immediate benefits
‚Ä¢ Health/MP restoration
‚Ä¢ XP and stat boosts
‚Ä¢ Combat enhancers
‚Ä¢ Utility effects

**‚öîÔ∏è Equipment** (Future)
Permanent gear that modifies your stats
‚Ä¢ Weapons for attack bonuses
‚Ä¢ Armor for defense increases  
‚Ä¢ Accessories for special effects
‚Ä¢ Faction-specific equipment

**üéÅ Quest Items**
Special items obtained from quests
‚Ä¢ Story progression items
‚Ä¢ Rare materials and components
‚Ä¢ Faction ability unlock requirements
‚Ä¢ Trading and crafting materials

**üíé Rare Items**
Legendary equipment and consumables
‚Ä¢ Unique stat combinations
‚Ä¢ Powerful special effects
‚Ä¢ Faction-exclusive benefits
‚Ä¢ Achievement rewards`
            },
            {
                name: 'Starting Equipment by Faction',
                content: `**üè¥‚Äç‚ò†Ô∏è One Piece Pirates:**
‚Ä¢ üó°Ô∏è Cutlass (weapon)  
‚Ä¢ üß• Pirate Coat (armor)
‚Ä¢ üß≠ Navigator's Compass (accessory)
‚Ä¢ üçñ Sea King Meat - 15 HP (2x)
‚Ä¢ üó∫Ô∏è Treasure Map Fragment (1x)

**ü•∑ Naruto Shinobi:**
‚Ä¢ üó°Ô∏è Kunai Set (weapon)
‚Ä¢ ü•ã Ninja Gear (armor)  
‚Ä¢ üìú Chakra Paper (accessory)
‚Ä¢ üíä Soldier Pill - 10 HP + stamina (3x)
‚Ä¢ üí® Smoke Bomb - escape combat (2x)

**üëÅÔ∏è Jujutsu Sorcerers:**
‚Ä¢ ‚öîÔ∏è Cursed Tool Basic (weapon)
‚Ä¢ üëî Sorcerer Uniform (armor)
‚Ä¢ üëÅÔ∏è Cursed Energy Detector (accessory)  
‚Ä¢ üíâ Cursed Energy Serum (2x)
‚Ä¢ üõ°Ô∏è Protective Charm - reduce curse damage (1x)

**‚öîÔ∏è Demon Slayers:**
‚Ä¢ ‚öîÔ∏è Nichirin Blade (weapon)
‚Ä¢ ü•ã Demon Slayer Corps Uniform (armor)
‚Ä¢ üìø Warding Charm (accessory)
‚Ä¢ üíä Recovery Pill - 20 HP over time (2x)  
‚Ä¢ üåÖ Sunlight Essence - extra demon damage (1x)`
            }
        ]
    },
    commands: {
        title: 'üíª Command Reference',
        description: 'Complete list of all available bot commands',
        sections: [
            {
                name: 'Character Management',
                content: `**\`/create <faction> [character_name]\`**
Create a new character in your chosen faction
‚Ä¢ **faction:** one_piece, naruto, jujutsu_kaisen, demon_slayer
‚Ä¢ **character_name:** Optional custom name (uses Discord name if not specified)

**\`/profile\`**
View your character stats, level, and progress
‚Ä¢ Shows HP, ATK, DEF, SPD, XP progress
‚Ä¢ Displays faction info and completed quests  
‚Ä¢ Shows faction-specific attributes

**\`/reset\`**
Permanently delete your character and start over
‚Ä¢ **WARNING:** This action cannot be undone!
‚Ä¢ Requires confirmation button click
‚Ä¢ Clears all progress, stats, and items`
            },
            {
                name: 'Gameplay Commands',
                content: `**\`/quest\`**
Start a random quest based on your level and faction
‚Ä¢ Faction bonuses apply to rewards
‚Ä¢ Enemy encounters possible during quests
‚Ä¢ Various quest categories available

**\`/inventory\`**
View all your items and equipment  
‚Ä¢ Shows consumables with quantities
‚Ä¢ Displays equipment and gear
‚Ä¢ Lists special and quest items

**\`/use <item> [quantity]\`**
Use consumable items from your inventory
‚Ä¢ Auto-complete suggests available items
‚Ä¢ Specify quantity or default to 1
‚Ä¢ Multiple effects possible per item`
            },
            {
                name: 'Information Commands',
                content: `**\`/wiki [category]\`**
Access this comprehensive help system
‚Ä¢ **getting_started** - New player guide
‚Ä¢ **factions** - Detailed faction information
‚Ä¢ **combat** - Battle mechanics and enemies  
‚Ä¢ **progression** - Leveling and abilities
‚Ä¢ **quests** - Quest system guide
‚Ä¢ **items** - Inventory and item management
‚Ä¢ **commands** - This command reference

**Command Tips:**
‚Ä¢ All commands work in any Discord channel where the bot is present
‚Ä¢ Use tab completion for faster command entry
‚Ä¢ Most commands provide helpful error messages if something goes wrong`
            }
        ]
    }
};

// Function to create wiki embed with navigation
function createWikiEmbed(category, sectionIndex = 0) {
    const cat = WIKI_CATEGORIES[category];
    if (!cat) return null;

    const section = cat.sections[sectionIndex];
    if (!section) return null;

    const embed = new EmbedBuilder()
        .setTitle(`${cat.title} - ${section.name}`)
        .setDescription(section.content)
        .setColor('#4a90e2')
        .setFooter({ 
            text: `Page ${sectionIndex + 1}/${cat.sections.length} | Cross Realm Chronicles Wiki` 
        })
        .setTimestamp();

    return embed;
}

// Function to create navigation components
function createWikiNavigation(category, currentSection = 0) {
    const cat = WIKI_CATEGORIES[category];
    if (!cat) return [];

    const components = [];

    // Section selection dropdown
    if (cat.sections.length > 1) {
        const sectionOptions = cat.sections.map((section, index) => ({
            label: section.name,
            value: `wiki_section_${category}_${index}`,
            description: section.content.substring(0, 100).replace(/\*\*/g, '').trim() + '...',
            default: index === currentSection
        }));

        const sectionSelect = new StringSelectMenuBuilder()
            .setCustomId(`wiki_section_${category}`)
            .setPlaceholder('Select a section to read about...')
            .addOptions(sectionOptions);

        components.push(new ActionRowBuilder().addComponents(sectionSelect));
    }

    // Navigation buttons
    const buttons = [];
    
    // Previous section button
    if (currentSection > 0) {
        buttons.push(
            new ButtonBuilder()
                .setCustomId(`wiki_prev_${category}_${currentSection}`)
                .setLabel('‚óÄ Previous')
                .setStyle(ButtonStyle.Secondary)
        );
    }

    // Back to category button
    buttons.push(
        new ButtonBuilder()
            .setCustomId(`wiki_category_${category}`)
            .setLabel('üìö Category Overview')
            .setStyle(ButtonStyle.Primary)
    );

    // Next section button
    if (currentSection < cat.sections.length - 1) {
        buttons.push(
            new ButtonBuilder()
                .setCustomId(`wiki_next_${category}_${currentSection}`)
                .setLabel('Next ‚ñ∂')
                .setStyle(ButtonStyle.Secondary)
        );
    }

    // Main menu button
    buttons.push(
        new ButtonBuilder()
            .setCustomId('wiki_main_menu')
            .setLabel('üè† Main Menu')
            .setStyle(ButtonStyle.Success)
    );

    if (buttons.length > 0) {
        components.push(new ActionRowBuilder().addComponents(buttons));
    }

    return components;
}

// Function to create category overview embed
function createCategoryOverviewEmbed(category) {
    const cat = WIKI_CATEGORIES[category];
    if (!cat) return null;

    let sectionList = cat.sections.map((section, index) => 
        `**${index + 1}.** ${section.name}\n*${section.content.substring(0, 80).replace(/\*\*/g, '').trim()}...*`
    ).join('\n\n');

    const embed = new EmbedBuilder()
        .setTitle(cat.title)
        .setDescription(`${cat.description}\n\n**Available Sections:**\n\n${sectionList}`)
        .setColor('#4a90e2')
        .setFooter({ text: 'Use the dropdown menu below to jump to any section' })
        .setTimestamp();

    return embed;
}

// Function to create category navigation
function createCategoryNavigation(category) {
    const cat = WIKI_CATEGORIES[category];
    if (!cat) return [];

    const components = [];

    // Section selection dropdown for category overview
    const sectionOptions = cat.sections.map((section, index) => ({
        label: section.name,
        value: `wiki_section_${category}_${index}`,
        description: section.content.substring(0, 100).replace(/\*\*/g, '').trim() + '...'
    }));

    const sectionSelect = new StringSelectMenuBuilder()
        .setCustomId(`wiki_section_${category}`)
        .setPlaceholder('Select a section to explore in detail...')
        .addOptions(sectionOptions);

    components.push(new ActionRowBuilder().addComponents(sectionSelect));

    // Main menu button
    const mainMenuButton = new ButtonBuilder()
        .setCustomId('wiki_main_menu')
        .setLabel('üè† Back to Main Menu')
        .setStyle(ButtonStyle.Success);

    components.push(new ActionRowBuilder().addComponents(mainMenuButton));

    return components;
}

// Function to create main wiki menu embed
function createMainWikiEmbed() {
    let categoryList = Object.entries(WIKI_CATEGORIES).map(([key, cat]) => 
        `${cat.title}\n*${cat.description}*`
    ).join('\n\n');

    const embed = new EmbedBuilder()
        .setTitle('üìö Cross Realm Chronicles - Complete Game Encyclopedia')
        .setDescription(`Welcome to your comprehensive guide for mastering Cross Realm Chronicles! This wiki contains everything you need to become a legendary adventurer across the anime multiverse.\n\n**Available Categories:**\n\n${categoryList}\n\n*Select any category below to begin exploring detailed guides, strategies, and game mechanics.*`)
        .setColor('#4a90e2')
        .setFooter({ text: 'Cross Realm Chronicles Wiki ‚Ä¢ Your complete adventure companion' })
        .setTimestamp();

    return embed;
}

// Function to create main menu navigation
function createMainMenuNavigation() {
    const categoryOptions = Object.entries(WIKI_CATEGORIES).map(([key, cat]) => ({
        label: cat.title.replace(/[^\w\s]/g, '').trim(),
        value: `wiki_category_${key}`,
        description: cat.description,
        emoji: cat.title.split(' ')[0] // Extract emoji from title
    }));

    const categorySelect = new StringSelectMenuBuilder()
        .setCustomId('wiki_main_categories')
        .setPlaceholder('üîç Choose a category to explore...')
        .addOptions(categoryOptions);

    return [new ActionRowBuilder().addComponents(categorySelect)];
}

// Function to get all category keys
function getCategoryKeys() {
    return Object.keys(WIKI_CATEGORIES);
}

// Function to get category info
function getCategoryInfo(category) {
    return WIKI_CATEGORIES[category] || null;
}

module.exports = {
    WIKI_CATEGORIES,
    createWikiEmbed,
    createWikiNavigation,
    createCategoryOverviewEmbed,
    createCategoryNavigation,
    createMainWikiEmbed,
    createMainMenuNavigation,
    getCategoryKeys,
    getCategoryInfo
};